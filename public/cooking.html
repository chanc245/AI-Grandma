<!doctype html>
<html>
<body onload="formatAMPM()">
  <head>
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <script src="https://cdn.jsdelivr.net/npm/jquery"></script>
      <script src="https://cdn.jsdelivr.net/npm/jquery.terminal/js/jquery.terminal.min.js"></script>
      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/jquery.terminal/css/jquery.terminal.min.css"/>
        <link rel="stylesheet" href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" type="text/css" />
        <link rel="icon" href="assets/img/grannybytes_favicon.png" type="image/x-icon">
      <link rel="stylesheet" href="./StyleCooking.css" />
      <title>Grandma.AI</title>
    </head>
    <title>Cook with Grandma!</title>
  </head>
  <body>

    <img class="overlay" src="assets/img/noiseoverlay.png"/>

    <audio src="assets/audio/grannyai.mp3"></audio>

    <div class="main-container">
      <div class="mitty-container hidden" id="appear">
        <img class="mitty" src="assets/img/UI/icons/icon_Mitty.png"/>
        <img class="speechbubble" src="assets/img/UI/icons/speech-bubble.png"/>
        <img class="mitty-bar" src="assets/img/UI/topbar/mitty_hints_topbar.png"/>
        <p class="mitty-text" style="font-family:'Half Bold Pixel-7';">
          Begin cooking with Granny! Refer to the ingredients below. You can also see the recipe steps and ask granny any questions you have by sending her a message!
        </p>
      </div>

    <div class="container">
      <div class="left-column">
        <div class="empty"></div>
        <div class="ingredients app">
          <div class="topbar_scroll" style="margin: 5px 5px 2px 5px;">
            <img src="assets/img/UI/topbar/ingredients_topbar.png" />
          </div>
          <div class="ingredients-container">
            <p id="recipe-text" style="font-family:'Half Bold Pixel-7';">
              <!--Default recipe text-->
              焢肉 Kong Rou<br /><br />
              Ingredients:<br />
              Cubed pork belly: 1 lb<br />
              Garlic: around 4 piece <br />
              Sugar: 1 Spoon <br />
              Green Onion: 2 piece<br />
              Soy Sauce: half a bowl <br />
              Water: 3 bowl <br /><br />
            </p>
        </div>
        </div>
      </div>

      <div class="grandma-ui box" style="padding: 5px; padding-bottom: 0;">
        <img src="assets/img/UI/topbar/grandma_conversation_topbar.png"/>
        
        <div class="inner-container">

          <div class="left">

            <div class="terminal inner-box">
              <div class="preloader visually-hidden"></div>
              <div class="inter" id="commandDiv"></div>
            </div>

            <div class="text-input inner-box" style="padding: 5px;">
              <img id="emoticonGif" src="assets/img/UI/topbar/emoticon/emoticon1.png" />
              <div class="user-chat-container">
                <!-- <input type="text" id="user_input" onkeypress="checkEnterKey(event)" placeholder="Chat with Grandma..."/> -->
                <textarea id="user_input" onkeypress="checkEnterKey(event)" placeholder="Chat with Grandma..." style="width: 220px; height: 100px; border-color: transparent;"></textarea>
                <button onclick="sendInput()" id="user_input" class="sendBtn">Send</button>
              </div>
            </div>
          </div>

          <div class="right">
            <div class="environment inner-box">
              <img id="rotatingImage" style="width: 100%; height: 100%;" src="assets/img/Grandma/g1.png"/>
            </div>
            <div class="cooking inner-box"  >
            </div>

            <div class="uploadPage inner-box">
              <button onclick="uploadPage()" id="upload-page" class="granny_result">Upload Cooking Results</button>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="scene-info">
        <img src="./assets/img/UI/icons/icon_Conversation.png">
        <p class="scene-info">Cook and chat with Granny</p>
      </div>
      <p class="scene-info" id="time">12:00PM</p>
    </div>
    </div>

  <!-- COMPUTER FRAME -->
  <div class="com-frame">
    <div class="com-bot-bar">
      <div class="bot-bar-container">
        <img src="./assets/img/retro-computer/com-connect-noclick.svg" class="bot-bar-svg">
        <img src="./assets/img/retro-computer/com-left-noclick.svg" class="bot-bar-svg">
        <img src="./assets/img/retro-computer/com-up-noclick.svg" class="bot-bar-svg">
        <img src="./assets/img/retro-computer/com-down-noclick.svg" class="bot-bar-svg">
        <img src="./assets/img/retro-computer/com-right-noclick.svg" class="bot-bar-svg">
        <div class="power-light"></div>
        <div class="power-btn" onclick="togglePower()"></div> 
      </div>    
    </div>
  </div>
  <div class="com-screen-off"></div>
  <!-- COMPUTER FRAME -->

    <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script> 
    <script type="module" src="dish.js"></script>
    <script src="script.js"></script>
    <script src="time.js"></script>
    <script>
      window.addEventListener("click", event => {
        const audio = document.querySelector("audio");
        audio.volume = 0.2;
        audio.play();
      });

      document.addEventListener("keydown", function(event) {
        const terminal = document.querySelector(".terminal");
        const scrollAmount = 2; // Adjust as needed

        if (event.key === "ArrowUp") {
          // Scroll up
          terminal.scrollTop -= scrollAmount;
          event.preventDefault(); // Prevent the default behavior of arrow keys
        } else if (event.key === "ArrowDown") {
          // Scroll down
          terminal.scrollTop += scrollAmount;
          event.preventDefault(); // Prevent the default behavior of arrow keys
        }
      });

      const resultPage = document.getElementById("upload-page");
      resultPage.addEventListener("click", () => {
        window.location.href = "./results.html";
      });

      // Array of image URLs for grandma's face 
      var imageUrls = [
          "assets/img/Grandma/g1.png",
          "assets/img/Grandma/g2.png"
      ];

      var currentIndex = 0;
      var rotatingImage = document.getElementById("rotatingImage");

      setInterval(function() {
          currentIndex = (currentIndex + 1) % imageUrls.length;
          rotatingImage.src = imageUrls[currentIndex];
      }, 1000);

      // Array of emoticons for the chat UI
      var emoticonUrls = [
          "assets/img/UI/topbar/emoticon/emoticon1.png",
          "assets/img/UI/topbar/emoticon/emoticon2.png",
          "assets/img/UI/topbar/emoticon/emoticon3.png",
          "assets/img/UI/topbar/emoticon/emoticon4.png",
          "assets/img/UI/topbar/emoticon/emoticon5.png",
          "assets/img/UI/topbar/emoticon/emoticon6.png",
      ];

      var currentEmoticon = 0;
      var emoticonGif = document.getElementById("emoticonGif");

      setInterval(function() {
        currentEmoticon = (currentEmoticon + 1) % emoticonUrls.length;
        emoticonGif.src = emoticonUrls[currentEmoticon];
      }, 1000);
    
      // TURN OFF COMPUTER //
    function togglePower() {
      var light = document.querySelector('.power-light');
      var screenOff = document.querySelector('.com-screen-off');

      // Toggle power light
      if (light.style.backgroundImage.includes('com-power-light-on.svg')) {
        light.style.backgroundImage = "url('./assets/img/retro-computer/com-power-light-off.svg')";
      } else {
        light.style.backgroundImage = "url('./assets/img/retro-computer/com-power-light-on.svg')";
      }

      // Toggle screen visibility
      if (screenOff.style.display === "none") {
        screenOff.style.display = "block";
      } else {
        screenOff.style.display = "none";
      }
    }
    // TURN OFF COMPUTER //
    </script>
    </body>
</html>
